#! /usr/bin/env bash
source color.sh
OH_MY_ZSH_DIR="$HOME/.oh-my-zsh"
OH_MY_ZSH_GITHUB="https://github.com/robbyrussell/oh-my-zsh.git"

TIG_DIR="$HOME/bin/tig"
TIG_GITHUB="https://github.com/jonas/tig.git"
TIG_BUILD="sh autogen.sh && echo 'configure' && ./configure && echo 'make' && make -j32 && echo 'systemwide install' && sudo make install"

RANGER_DIR="$HOME/bin/ranger"
RANGER_GITHUB="https://github.com/hut/ranger.git"
RANGER_BUILD="sudo make install"

AG_DIR="$HOME/bin/ag"
AG_GITHUB="https://github.com/ggreer/the_silver_searcher.git"
AG_BUILD="sudo apt-get install -y automake pkg-config libpcre3-dev zlib1g-dev liblzma-dev && ./build.sh && sudo make install"

TMUX_DIR="$HOME/bin/tmux"
TMUX_GITHUB="https://github.com/ThomasAdam/tmux.git"
TMUX_BUILD="sh autogen.sh && echo 'configure' && ./configure && echo 'make' && make -j32 && echo 'systemwide install' && sudo make install"

clone_or_update() {
  if [ -d "$2" ]
  then
    echo "$2 is exist"
    echo ">> Run git pull for $2 <<"
    pushd .
    cd $2
    git pull --rebase
    popd
  else
    git clone $1 $2
  fi
  if [ ! -z "${3}" ]
  then
    echo ">> Let's build! <<"
    pushd .
    echo ">>> Move ${2} <<<"
    cd ${2}
    echo ">> Do: ${3} <<"
    eval ${3}
    popd
  fi
}
cp -R ../module/bin/* $HOME/bin
clone_or_update $OH_MY_ZSH_GITHUB $OH_MY_ZSH_DIR
clone_or_update $TIG_GITHUB $TIG_DIR "${TIG_BUILD}"
clone_or_update $RANGER_GITHUB $RANGER_DIR "${RANGER_BUILD}"
clone_or_update $AG_GITHUB $AG_DIR "${AG_BUILD}"
clone_or_update $TMUX_GITHUB $TMUX_DIR "${TMUX_BUILD}"

